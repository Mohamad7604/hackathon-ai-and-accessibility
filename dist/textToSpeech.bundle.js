new class{constructor(){this.utterance=null,this.isPlaying=!1,this.currentNode=null,this.initializeControls()}initializeControls(){const t=document.createElement("div");t.innerHTML='\n            <div id="tts-controls" style="\n                position: fixed;\n                bottom: 20px;\n                right: 20px;\n                background: white;\n                padding: 10px;\n                border-radius: 5px;\n                box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n                z-index: 10000;\n            ">\n                <button id="tts-play">Play</button>\n                <select id="tts-rate">\n                    <option value="0.5">0.5x</option>\n                    <option value="0.8" selected>0.8x</option>\n                    <option value="1.0">1.0x</option>\n                </select>\n            </div>\n        ',document.body.appendChild(t),document.getElementById("tts-play").addEventListener("click",(()=>this.toggleSpeech())),document.getElementById("tts-rate").addEventListener("change",(t=>this.setRate(t.target.value)))}toggleSpeech(){this.isPlaying?(speechSynthesis.cancel(),this.isPlaying=!1,document.getElementById("tts-play").textContent="Play",this.removeHighlight()):this.startReading()}startReading(){const t=document.body.innerText;this.utterance=new SpeechSynthesisUtterance(t),this.utterance.rate=parseFloat(document.getElementById("tts-rate").value),this.utterance.onboundary=t=>{"word"===t.name&&this.highlightWord(t)},this.utterance.onend=()=>{this.isPlaying=!1,document.getElementById("tts-play").textContent="Play",this.removeHighlight()},speechSynthesis.speak(this.utterance),this.isPlaying=!0,document.getElementById("tts-play").textContent="Pause"}setRate(t){this.utterance&&(this.utterance.rate=parseFloat(t))}highlightWord(t){this.removeHighlight();const e=document.body.innerText.split(" ");let n=0,i=0;for(let o=0;o<e.length;o++){if(n+e[o].length>=t.charIndex){i=o;break}n+=e[o].length+1}const o=document.createRange(),s=document.createTreeWalker(document.body,NodeFilter.SHOW_TEXT,null,!1);let a=s.nextNode();for(;a;){if(a.textContent.includes(e[i])){const t=a.textContent.indexOf(e[i]);o.setStart(a,t),o.setEnd(a,t+e[i].length);const n=document.createElement("span");n.style.backgroundColor="yellow",n.className="tts-highlight",o.surroundContents(n);break}a=s.nextNode()}}removeHighlight(){document.querySelectorAll(".tts-highlight").forEach((t=>{const e=t.parentNode;e.replaceChild(document.createTextNode(t.textContent),t),e.normalize()}))}};
//# sourceMappingURL=textToSpeech.bundle.js.map